<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.3.433">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Robson Bruno Dutra Perreira">

<title>Regressão linear simples, múltipla e polinomial</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="AS_reg_ols_files/libs/clipboard/clipboard.min.js"></script>
<script src="AS_reg_ols_files/libs/quarto-html/quarto.js"></script>
<script src="AS_reg_ols_files/libs/quarto-html/popper.min.js"></script>
<script src="AS_reg_ols_files/libs/quarto-html/tippy.umd.min.js"></script>
<script src="AS_reg_ols_files/libs/quarto-html/anchor.min.js"></script>
<link href="AS_reg_ols_files/libs/quarto-html/tippy.css" rel="stylesheet">
<link href="AS_reg_ols_files/libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="AS_reg_ols_files/libs/bootstrap/bootstrap.min.js"></script>
<link href="AS_reg_ols_files/libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="AS_reg_ols_files/libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">

  <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

</head>

<body class="fullcontent">

<div id="quarto-content" class="page-columns page-rows-contents page-layout-article">

<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Regressão linear simples, múltipla e polinomial</h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Robson Bruno Dutra Perreira </p>
          </div>
  </div>
    
  
    
  </div>
  

</header>

<section id="regressão-linear-simples-múltipla-e-polinomial" class="level2">
<h2 class="anchored" data-anchor-id="regressão-linear-simples-múltipla-e-polinomial">Regressão linear simples, múltipla e polinomial</h2>
<section id="regressão-linear-simples" class="level3">
<h3 class="anchored" data-anchor-id="regressão-linear-simples">Regressão linear simples</h3>
<p>Seja um problema onde deseja-se prever uma resposta contínua, <span class="math inline">\(y \in \mathbb{R}\)</span>, em função de uma única variável independente também contínua, <span class="math inline">\(x \in \mathbb{R}\)</span>. Conforme observado graficamente abaixo, pode-se considerar em diversos casos a aproximação de uma função linear para tal relação.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="AS_reg_ols_files/figure-html/unnamed-chunk-2-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Tal aproximação pode ser descrita pela Equação à seguir, onde <span class="math inline">\(\hat{y}\)</span> consiste no valor predito de <span class="math inline">\(y\)</span>, <span class="math inline">\(\beta_0\)</span> e <span class="math inline">\(\beta_1\)</span> são coeficientes chamados de intercepto ou constante e coeficiente linear ou inclinação, respectivamente. Enquanto <span class="math inline">\(\beta_0\)</span> mede o valor da resposta prevista para <span class="math inline">\(x=0\)</span>, <span class="math inline">\(\beta_1\)</span> consiste na mudança média da resposta para o incremento de uma unidade de <span class="math inline">\(x\)</span>.</p>
<p><span class="math display">\[
\hat{y} = \beta_0 + \beta_1x
\]</span></p>
<p>A seguir pode-se observar para os dados plotados anteriormente a linha azul do modelo de regressão linear simples obtido.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="AS_reg_ols_files/figure-html/unnamed-chunk-3-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Para este caso inicial os coeficientes de regressão estimados são:</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)           x 
  10.927762    2.728817 </code></pre>
</div>
</div>
<p>A primeira pergunta a ser feita seria como estimar tais coeficientes de regressão. Pode-se pensar em estimativas que minimizem o erro de previsão. Conforme, plotado a seguir em linhas verticais vermelhas, o erro de previsão seria a diferença entre o valor experimental e o previsto, <span class="math inline">\(\varepsilon_i = y_i - \hat{y}_i\)</span>, <span class="math inline">\(i = 1, ...., N\)</span>.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="AS_reg_ols_files/figure-html/unnamed-chunk-5-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Neste sentido, as observações da variável dependente ou resposta podem ser descritas conforme segue.</p>
<p><span class="math display">\[
\begin{aligned}
y_i = \hat{y}_i + \varepsilon_i \\
y_i = \beta_0 + \beta_1x_i + \varepsilon_i \\
\end{aligned}
\]</span></p>
<p>Tomando <span class="math inline">\(N\)</span> observações retiradas da população de interesse, <span class="math inline">\((x_1, y_1), (x_2, y_2), ..., (x_N, y_N)\)</span>, pode-se pensar em um modelo que minimize os erros de previsão para a amostra disponível. Uma vez que o erro é normalmente distribuído, com média nula e variância <span class="math inline">\(\sigma_\varepsilon^2\)</span>, sendo os resíduos normalmente distribuídos, com média nula e variância igual a <span class="math inline">\(\sigma_\varepsilon^2\)</span>, <span class="math inline">\(\varepsilon \sim N(0,\sigma_\varepsilon^2)\)</span>, pode-se trabalhar a minimização da soma dos quadrados dos erros de previsão, <span class="math inline">\(\sum_{i=1}^{N}\varepsilon_i^2\)</span>.</p>
<p>A seguir observam-se algumas das observações para os dados plotados anteriormente, bem como os valores preditos e erros associados.</p>
<div class="cell">
<div class="cell-output-display">

<div id="dbasxsvqlx" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#dbasxsvqlx table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#dbasxsvqlx thead, #dbasxsvqlx tbody, #dbasxsvqlx tfoot, #dbasxsvqlx tr, #dbasxsvqlx td, #dbasxsvqlx th {
  border-style: none;
}

#dbasxsvqlx p {
  margin: 0;
  padding: 0;
}

#dbasxsvqlx .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#dbasxsvqlx .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#dbasxsvqlx .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#dbasxsvqlx .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#dbasxsvqlx .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dbasxsvqlx .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dbasxsvqlx .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#dbasxsvqlx .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#dbasxsvqlx .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#dbasxsvqlx .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#dbasxsvqlx .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#dbasxsvqlx .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#dbasxsvqlx .gt_spanner_row {
  border-bottom-style: hidden;
}

#dbasxsvqlx .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#dbasxsvqlx .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#dbasxsvqlx .gt_from_md > :first-child {
  margin-top: 0;
}

#dbasxsvqlx .gt_from_md > :last-child {
  margin-bottom: 0;
}

#dbasxsvqlx .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#dbasxsvqlx .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#dbasxsvqlx .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#dbasxsvqlx .gt_row_group_first td {
  border-top-width: 2px;
}

#dbasxsvqlx .gt_row_group_first th {
  border-top-width: 2px;
}

#dbasxsvqlx .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dbasxsvqlx .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#dbasxsvqlx .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#dbasxsvqlx .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dbasxsvqlx .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#dbasxsvqlx .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#dbasxsvqlx .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#dbasxsvqlx .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#dbasxsvqlx .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#dbasxsvqlx .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dbasxsvqlx .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dbasxsvqlx .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#dbasxsvqlx .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#dbasxsvqlx .gt_left {
  text-align: left;
}

#dbasxsvqlx .gt_center {
  text-align: center;
}

#dbasxsvqlx .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#dbasxsvqlx .gt_font_normal {
  font-weight: normal;
}

#dbasxsvqlx .gt_font_bold {
  font-weight: bold;
}

#dbasxsvqlx .gt_font_italic {
  font-style: italic;
}

#dbasxsvqlx .gt_super {
  font-size: 65%;
}

#dbasxsvqlx .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#dbasxsvqlx .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#dbasxsvqlx .gt_indent_1 {
  text-indent: 5px;
}

#dbasxsvqlx .gt_indent_2 {
  text-indent: 10px;
}

#dbasxsvqlx .gt_indent_3 {
  text-indent: 15px;
}

#dbasxsvqlx .gt_indent_4 {
  text-indent: 20px;
}

#dbasxsvqlx .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="x">x</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="y">y</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="y_hat">y_hat</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="erro">erro</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="x" class="gt_row gt_right">1.093333</td>
<td headers="y" class="gt_row gt_right">9.389117</td>
<td headers="y_hat" class="gt_row gt_right">13.91127</td>
<td headers="erro" class="gt_row gt_right">-4.5221504</td></tr>
    <tr><td headers="x" class="gt_row gt_right">4.106335</td>
<td headers="y" class="gt_row gt_right">29.785746</td>
<td headers="y_hat" class="gt_row gt_right">22.13320</td>
<td headers="erro" class="gt_row gt_right">7.6525477</td></tr>
    <tr><td headers="x" class="gt_row gt_right">9.138367</td>
<td headers="y" class="gt_row gt_right">29.774229</td>
<td headers="y_hat" class="gt_row gt_right">35.86469</td>
<td headers="erro" class="gt_row gt_right">-6.0904613</td></tr>
    <tr><td headers="x" class="gt_row gt_right">24.613730</td>
<td headers="y" class="gt_row gt_right">78.467084</td>
<td headers="y_hat" class="gt_row gt_right">78.09412</td>
<td headers="erro" class="gt_row gt_right">0.3729679</td></tr>
    <tr><td headers="x" class="gt_row gt_right">38.963444</td>
<td headers="y" class="gt_row gt_right">126.273606</td>
<td headers="y_hat" class="gt_row gt_right">117.25185</td>
<td headers="erro" class="gt_row gt_right">9.0217521</td></tr>
    <tr><td headers="x" class="gt_row gt_right">56.628047</td>
<td headers="y" class="gt_row gt_right">155.103936</td>
<td headers="y_hat" class="gt_row gt_right">165.45531</td>
<td headers="erro" class="gt_row gt_right">-10.3513755</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>A sintaxe anteriormente apresentada pode ser escrita de forma matricial, conforme segue, onde <span class="math inline">\(\mathbf{x}_{[2 \times N]}\)</span> consiste em uma matriz relacionada às observações independentes, com uma coluna de valores unitários associada à <span class="math inline">\(\beta_0\)</span> e outra com as observações de <span class="math inline">\(x\)</span>, portanto associada a <span class="math inline">\(\beta_1\)</span>. <span class="math inline">\(\mathbf{y}_{[N\times1]}\)</span> consiste no vetor de observações da resposta, <span class="math inline">\(\mathbf{\varepsilon}_{[N\times1]}\)</span> consiste no vetor de erros ou resíduos de previsão e <span class="math inline">\(\mathbf{\beta}_{[2\times1]}\)</span> consiste em um vetor de coeficientes.</p>
<p><span class="math display">\[
\begin{aligned}
\mathbf{y} = \mathbf{X}\mathbf{\beta} + \mathbf{\varepsilon}
\end{aligned}
\]</span></p>
<p>Tais elementos matriciais podem ser escritos de forma genérica conforme segue.</p>
<p><span class="math display">\[
\mathbf{X} =
\begin{bmatrix}
1 &amp; x_{1}\\
1 &amp; x_{2}\\
\vdots &amp; \vdots \\
1 &amp; x_{N}\\
\end{bmatrix} =
\begin{bmatrix}
1 &amp; 1.093\\
1 &amp; 4.106\\
\vdots &amp; \vdots \\
1 &amp; 96.206\\
\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
\mathbf{y} =
\begin{bmatrix}
y_{1}\\
y_{2}\\
\vdots \\
y_{N}\\
\end{bmatrix} =
\begin{bmatrix}
9.389\\
29.786\\
\vdots \\
290.028\\
\end{bmatrix}
\]</span></p>
<p><span class="math display">\[
\mathbf{\varepsilon} =
\begin{bmatrix}
\varepsilon_{1}\\
\varepsilon_{2}\\
\vdots \\
\varepsilon_{N}\\
\end{bmatrix} =
\begin{bmatrix}
-4.522\\
7.653\\
\vdots \\
16.571\\
\end{bmatrix}\text{,    e} \\
\]</span></p>
<p><span class="math display">\[
\mathbf{\beta}^T =
\begin{bmatrix}
\beta_0 &amp; \beta_1\\
\end{bmatrix} =
\begin{bmatrix}
10.928  &amp; 2.729 \\
\end{bmatrix}
\]</span></p>
<p>Tomando tal notação, a soma dos quadrados dos erros pode ser descrita como <span class="math inline">\(\sum_{i=1}^{N}\varepsilon_i^2 = \mathbf{\varepsilon}^T\mathbf{\varepsilon}\)</span>. Desenvolvendo tal expressão tem-se:</p>
<p><span class="math display">\[
\begin{aligned}
L(\mathbf{\beta}) = \mathbf{\varepsilon}^T\mathbf{\varepsilon} = (\mathbf{y} - \mathbf{X}\mathbf{\beta})^T(\mathbf{y} - \mathbf{X}\mathbf{\beta}) \\
\mathbf{y}^T\mathbf{y} - 2\mathbf{\beta}^T\mathbf{X}^T\mathbf{y} + \mathbf{\beta}^T\mathbf{X}^T\mathbf{X}\mathbf{\beta}
\end{aligned}
\]</span></p>
<p>Para minimizar <span class="math inline">\(L\)</span> em relação à estimativa de <span class="math inline">\(\mathbf{\beta}\)</span>, pode-se diferenciar tal quantidade em relação à <span class="math inline">\(\mathbf{\beta}\)</span> e igualar a zero:</p>
<p><span class="math display">\[
\begin{aligned}
\frac{\partial L}{\partial \mathbf{\beta}} = -2\mathbf{X}^T\mathbf{y} + 2\mathbf{X}^T\mathbf{X}\mathbf{\beta} = 0 \\
\hat{\mathbf{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}(\mathbf{X}^T\mathbf{y})
\end{aligned}
\]</span></p>
<p>Tal solução constitui as chamadas equações normais de mínimos quadrados.</p>
<p>Ao obter um modelo de regressão é sempre importante observar os resíduos, os quais devem ser normalmente distribuídos, independentes e homocedásticos. Tais pressuposições implicam que o modelo o obtido por mínimos quadrados é paramétrico, uma vez que pressupõe-se uma distribuição para os resíduos. Neste curso de aprendizado não supervisionado, serão estudados diversos modelos que não implicam qualquer distribuição acerca dos resíduos ou dados sendo, portanto, livres de distribuição e ditos não-paramétricos.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="AS_reg_ols_files/figure-html/unnamed-chunk-7-1.png" class="img-fluid" width="672"></p>
</div>
</div>
</section>
<section id="regressão-linear-múltipla" class="level3">
<h3 class="anchored" data-anchor-id="regressão-linear-múltipla">Regressão linear múltipla</h3>
<p>No caso de onde há múltiplas variáveis independentes ou regressoras de interesse, <span class="math inline">\(x_1, x_2, ..., x_k\)</span> pode-se considerar o modelo com um coeficiente linear associado a cada variável, isto é:</p>
<p><span class="math display">\[
\hat{y}_i = \beta_0 + \beta_1x_{i1} + \beta_2x_{i2} + \cdots + \beta_kx_{ik} = \beta_0 + \sum_{j=1}^{k}\beta_jx_{ij},  
\]</span></p>
<p>ou de forma matricial com <span class="math inline">\(\mathbf{X}_{[N\times k+1]}\)</span> e <span class="math inline">\(\mathbf{\beta}_{[k+1 \times 1]}\)</span>:</p>
<p><span class="math display">\[
\begin{aligned}
\hat{\mathbf{y}} = \mathbf{X}\mathbf{\beta}
\end{aligned},
\]</span> com:</p>
<p><span class="math display">\[
\mathbf{X} =
\begin{bmatrix}
1 &amp; x_{11} &amp; x_{12} &amp; \cdots &amp; x_{1k}\\
1 &amp; x_{21} &amp; x_{22} &amp; \cdots &amp; x_{2k} \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
1 &amp; x_{N1} &amp; x_{N2} &amp; \cdots &amp; x_{Nk} \\
\end{bmatrix}, e\\
\]</span></p>
<p><span class="math display">\[
\mathbf{\beta}^T =
\begin{bmatrix}
\beta_0 &amp; \beta_1 &amp; \cdots &amp; \beta_k\\
\end{bmatrix}. \\
\]</span></p>
<p>As estimativas de mínimos quadrados, deduzidas para o caso simples, <span class="math inline">\(\hat{\mathbf{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}(\mathbf{X}^T\mathbf{y})\)</span>, também atendem ao caso múltiplo. Uma forma de medir o ajuste do modelo obtido aos dados seria a partir do cálculo do coeficiente de determinação múltipla, <span class="math inline">\(R^2\)</span>, conforme segue,</p>
<p><span class="math display">\[
\begin{align}
R^2 = 1- SS_{E}/SS_T \\
R^2 = 1- \frac{\sum_{i=1}^{N}(y_i-\hat{y}_i)^2}{\sum_{i=1}^{N}(y_i-\overline{y}_i)^2},
\end{align}
\]</span></p>
<p>ou utilizando outras métricas de ajuste. É interessante que tais métricas sejam também calculadas para dados futuros ou de teste, de forma a evitar sobreajuste do modelo. Uma observação importante é relacionada à utilização da ANOVA para obtenção de tais métricas. Além do <span class="math inline">\(R^2\)</span>, ao se utilizar a ANOVA, há a possibilidade de calcular o coeficiente de determinação ajustado, <span class="math inline">\(R^2_{adj}\)</span>, isto é:</p>
<p><span class="math display">\[
R^2_{adj} = 1 - \frac{SS_{E}/(N-k)}{SS_T/(N-1)}
\]</span></p>
<p>Esta métrica é mais honesta uma vez que penaliza o modelo pela adição de mais coeficientes. O <span class="math inline">\(R^2\)</span> sempre aumentará com adição de novos coeficientes, enquanto o <span class="math inline">\(R^2_{adj}\)</span> será mais baixo casos novos termos adicionados não apresentem significância estatística. Entretanto, quando outros métodos de aprendizado não paramétricos são utilizados, especialmente os que não tem origem na estatística mas na computação, tal métrica não pode ser calculada. No contexto de aprendizado supervisionado é mais interessante realizar a validação cruzada e estimar o desempenho do modelo em dados futuros, viabilizando a comparação de tipos distintos de modelos.</p>
<p>O teste t para os coeficientes de regressão pode ser calculado para medir a significância de cada coeficiente e testar as seguintes hipóteses para cada coeficiente de regressão.</p>
<p><span class="math display">\[
\begin{matrix}
H_0: \beta_j = 0 \\
H_1: \beta_j \neq 0, j = 1, ..., k\\
\end{matrix}
\]</span></p>
<p>O teste é calculado conforme segue, onde <span class="math inline">\(C_j\)</span> é o valor da <span class="math inline">\(j\)</span>-ésima linha e <span class="math inline">\(j\)</span>-ésima coluna da matriz <span class="math inline">\((\mathbf{X}^T\mathbf{X})^{-1}\)</span>, correspondente a <span class="math inline">\(\beta_j\)</span>. A hipótese nula é rejeitada se <span class="math inline">\(t_{0j} &gt; t_{[\alpha/2,N-k]}\)</span>, onde <span class="math inline">\(\alpha\)</span> é o nível de significância de interesse.</p>
<p><span class="math display">\[
t_{0j} = \frac{\hat{\beta}_j}{\sqrt{C_jSS_E/(N-k)}}
\]</span></p>
<p>Analogamente, estimativas intervalares para os coeficientes podem ser obtidas como segue, as quais consistem em intervalos que garantem <span class="math inline">\(\gamma = 1-\alpha\)</span> de confiança de encontrar os verdadeiros valores dos coeficientes de regressão.</p>
<p><span class="math display">\[
\hat{\beta}_j \pm t_{[\alpha/2,N-k]}\sqrt{C_jSS_E/(N-k)}
\]</span></p>
<p>A seguir ilustra-se graficamente um modelo de regressão linear múltipla para prever o preço de carros usados em função da idade e quilometragem.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="AS_reg_ols_files/figure-html/unnamed-chunk-8-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Para este caso, os coeficientes estimados são apresentados a seguir. Estes foram estimados nas unidades originais das variáveis. Porém, para fins de inferência, é importante padronizar as variáveis regressoras.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>(Intercept)     Mileage         Age 
21.54307990 -0.05314626 -0.84234949 </code></pre>
</div>
</div>
<p>O modelo pode ser escrito conforme segue.</p>
<p><span class="math display">\[
\hat{y} = 21,543 - 0,0531x_1 - 0,842x_2
\]</span></p>
<p>O teste t para os coeficientes de regressão resultante é apresentado a seguir. As duas variáveis regressoras foram antes padronizadas para evitar efeito de escala e unidade de medida. Como <span class="math inline">\(|t_{\alpha/2,N-k}|\)</span> = 1.987, tem-se que todos os coeficientes são significativos, uma vez que <span class="math inline">\(t_{0j} &gt; t_{\alpha/2,N-k}\)</span>, <span class="math inline">\(\forall j = 1, ..., k\)</span>. Pode-se também considerar o <span class="math inline">\(p-value\)</span> que é a probabilidade de erro na rejeição da hipótese nula, <span class="math inline">\(H_0\)</span>, associada ao valor calculado <span class="math inline">\(t_0\)</span>. Se <span class="math inline">\(p-value &lt; \alpha\)</span>, rejeita-se <span class="math inline">\(H_0\)</span>.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ Mileage + Age, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.5429 -1.2795 -0.2982  1.5275  7.1967 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  13.7478     0.2483  55.364  &lt; 2e-16 ***
Mileage      -1.9401     0.4406  -4.404 3.02e-05 ***
Age          -3.3175     0.4406  -7.530 4.42e-11 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.356 on 87 degrees of freedom
Multiple R-squared:  0.8239,    Adjusted R-squared:  0.8198 
F-statistic: 203.5 on 2 and 87 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>A seguir apresentam-se intervalos de confiança de 0.95 para os coeficientes codificados.</p>
<div class="cell">
<div class="cell-output-display">

<div id="jvwgobqnyy" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#jvwgobqnyy table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#jvwgobqnyy thead, #jvwgobqnyy tbody, #jvwgobqnyy tfoot, #jvwgobqnyy tr, #jvwgobqnyy td, #jvwgobqnyy th {
  border-style: none;
}

#jvwgobqnyy p {
  margin: 0;
  padding: 0;
}

#jvwgobqnyy .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#jvwgobqnyy .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#jvwgobqnyy .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#jvwgobqnyy .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#jvwgobqnyy .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jvwgobqnyy .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jvwgobqnyy .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#jvwgobqnyy .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#jvwgobqnyy .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#jvwgobqnyy .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#jvwgobqnyy .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#jvwgobqnyy .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#jvwgobqnyy .gt_spanner_row {
  border-bottom-style: hidden;
}

#jvwgobqnyy .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#jvwgobqnyy .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#jvwgobqnyy .gt_from_md > :first-child {
  margin-top: 0;
}

#jvwgobqnyy .gt_from_md > :last-child {
  margin-bottom: 0;
}

#jvwgobqnyy .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#jvwgobqnyy .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#jvwgobqnyy .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#jvwgobqnyy .gt_row_group_first td {
  border-top-width: 2px;
}

#jvwgobqnyy .gt_row_group_first th {
  border-top-width: 2px;
}

#jvwgobqnyy .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jvwgobqnyy .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#jvwgobqnyy .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#jvwgobqnyy .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jvwgobqnyy .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#jvwgobqnyy .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#jvwgobqnyy .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#jvwgobqnyy .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#jvwgobqnyy .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#jvwgobqnyy .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jvwgobqnyy .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jvwgobqnyy .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#jvwgobqnyy .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#jvwgobqnyy .gt_left {
  text-align: left;
}

#jvwgobqnyy .gt_center {
  text-align: center;
}

#jvwgobqnyy .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#jvwgobqnyy .gt_font_normal {
  font-weight: normal;
}

#jvwgobqnyy .gt_font_bold {
  font-weight: bold;
}

#jvwgobqnyy .gt_font_italic {
  font-style: italic;
}

#jvwgobqnyy .gt_super {
  font-size: 65%;
}

#jvwgobqnyy .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#jvwgobqnyy .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#jvwgobqnyy .gt_indent_1 {
  text-indent: 5px;
}

#jvwgobqnyy .gt_indent_2 {
  text-indent: 10px;
}

#jvwgobqnyy .gt_indent_3 {
  text-indent: 15px;
}

#jvwgobqnyy .gt_indent_4 {
  text-indent: 20px;
}

#jvwgobqnyy .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="X2.5..">X2.5..</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="X97.5..">X97.5..</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="X2.5.." class="gt_row gt_right">13.254224</td>
<td headers="X97.5.." class="gt_row gt_right">14.241331</td></tr>
    <tr><td headers="X2.5.." class="gt_row gt_right">-2.815845</td>
<td headers="X97.5.." class="gt_row gt_right">-1.064452</td></tr>
    <tr><td headers="X2.5.." class="gt_row gt_right">-4.193231</td>
<td headers="X97.5.." class="gt_row gt_right">-2.441839</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Além de considerar termos de múltiplas variáveis, é possível considerar a interação entre estas, colocando na matriz <span class="math inline">\(\mathbf{X}\)</span> colunas com multiplicação ou produto de colunas das variáveis de interesse e no modelo termos da forma <span class="math inline">\(\beta_{ij}x_ix_j\)</span>. Para o caso em estudo um modelo de regressão múltipla com interação ficaria conforme segue.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ Mileage * Age, data = data)

Residuals:
    Min      1Q  Median      3Q     Max 
-5.1277 -1.4495 -0.2671  1.7765  6.1130 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  13.0272     0.3381  38.532  &lt; 2e-16 ***
Mileage      -2.0909     0.4247  -4.924 4.06e-06 ***
Age          -3.7683     0.4477  -8.417 7.55e-13 ***
Mileage:Age   0.8844     0.2952   2.997  0.00357 ** 
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.255 on 86 degrees of freedom
Multiple R-squared:  0.8405,    Adjusted R-squared:  0.835 
F-statistic: 151.1 on 3 and 86 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="codificação-de-variáveis-categóricas-em-regressão-múltipla" class="level3">
<h3 class="anchored" data-anchor-id="codificação-de-variáveis-categóricas-em-regressão-múltipla">Codificação de variáveis categóricas em regressão múltipla</h3>
<p>Retomando o problema de regressão do preço de revenda de carros considerando o ano e a quilometragem, imagine uma terceira variável regressora que determina o modelo ou tipo do veículo. Tal variável apresenta três categorias, <em>Mazda6</em>, <em>Accord</em> e <em>Maxima</em>.</p>
<div class="cell">
<div class="cell-output-display">

<div id="rsernmpahi" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#rsernmpahi table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#rsernmpahi thead, #rsernmpahi tbody, #rsernmpahi tfoot, #rsernmpahi tr, #rsernmpahi td, #rsernmpahi th {
  border-style: none;
}

#rsernmpahi p {
  margin: 0;
  padding: 0;
}

#rsernmpahi .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#rsernmpahi .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#rsernmpahi .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#rsernmpahi .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#rsernmpahi .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rsernmpahi .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rsernmpahi .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#rsernmpahi .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#rsernmpahi .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#rsernmpahi .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#rsernmpahi .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#rsernmpahi .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#rsernmpahi .gt_spanner_row {
  border-bottom-style: hidden;
}

#rsernmpahi .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#rsernmpahi .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#rsernmpahi .gt_from_md > :first-child {
  margin-top: 0;
}

#rsernmpahi .gt_from_md > :last-child {
  margin-bottom: 0;
}

#rsernmpahi .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#rsernmpahi .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#rsernmpahi .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#rsernmpahi .gt_row_group_first td {
  border-top-width: 2px;
}

#rsernmpahi .gt_row_group_first th {
  border-top-width: 2px;
}

#rsernmpahi .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rsernmpahi .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#rsernmpahi .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#rsernmpahi .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rsernmpahi .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#rsernmpahi .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#rsernmpahi .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#rsernmpahi .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#rsernmpahi .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#rsernmpahi .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rsernmpahi .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rsernmpahi .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#rsernmpahi .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#rsernmpahi .gt_left {
  text-align: left;
}

#rsernmpahi .gt_center {
  text-align: center;
}

#rsernmpahi .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#rsernmpahi .gt_font_normal {
  font-weight: normal;
}

#rsernmpahi .gt_font_bold {
  font-weight: bold;
}

#rsernmpahi .gt_font_italic {
  font-style: italic;
}

#rsernmpahi .gt_super {
  font-size: 65%;
}

#rsernmpahi .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#rsernmpahi .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#rsernmpahi .gt_indent_1 {
  text-indent: 5px;
}

#rsernmpahi .gt_indent_2 {
  text-indent: 10px;
}

#rsernmpahi .gt_indent_3 {
  text-indent: 15px;
}

#rsernmpahi .gt_indent_4 {
  text-indent: 20px;
}

#rsernmpahi .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="CarType">CarType</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Age">Age</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Mileage">Mileage</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Price">Price</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="CarType" class="gt_row gt_center">Mazda6</td>
<td headers="Age" class="gt_row gt_right">3</td>
<td headers="Mileage" class="gt_row gt_right">17.8</td>
<td headers="Price" class="gt_row gt_right">15.9</td></tr>
    <tr><td headers="CarType" class="gt_row gt_center">Mazda6</td>
<td headers="Age" class="gt_row gt_right">2</td>
<td headers="Mileage" class="gt_row gt_right">19.0</td>
<td headers="Price" class="gt_row gt_right">16.4</td></tr>
    <tr><td headers="CarType" class="gt_row gt_center">Accord</td>
<td headers="Age" class="gt_row gt_right">10</td>
<td headers="Mileage" class="gt_row gt_right">150.5</td>
<td headers="Price" class="gt_row gt_right">7.9</td></tr>
    <tr><td headers="CarType" class="gt_row gt_center">Accord</td>
<td headers="Age" class="gt_row gt_right">5</td>
<td headers="Mileage" class="gt_row gt_right">65.2</td>
<td headers="Price" class="gt_row gt_right">11.7</td></tr>
    <tr><td headers="CarType" class="gt_row gt_center">Maxima</td>
<td headers="Age" class="gt_row gt_right">1</td>
<td headers="Mileage" class="gt_row gt_right">38.6</td>
<td headers="Price" class="gt_row gt_right">20.0</td></tr>
    <tr><td headers="CarType" class="gt_row gt_center">Maxima</td>
<td headers="Age" class="gt_row gt_right">1</td>
<td headers="Mileage" class="gt_row gt_right">42.1</td>
<td headers="Price" class="gt_row gt_right">20.0</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>Para trabalhar com a variável modelo e qualquer outra variável qualitativa ou categórica em regressão múltipla, pode-se utilizar de variáveis <em>dummy</em> também conhecidas como indicativas ou binárias. No caso de três categorias, como no exemplo acima, duas variáveis <em>dummy</em> seriam suficientes. Ao criar uma coluna denominada <code>Mazda6</code>, com 1, se <code>Mazda6</code> e 0, caso contrário e, de forma análoga, uma coluna para <code>Accord</code>, caso uma determinada observação receba 0 em ambas colunas, o modelo do carro consiste no <code>Maxima</code>.</p>
<p>Seja <span class="math inline">\(x_1\)</span> o ano, <span class="math inline">\(x_2\)</span> a quiometragem, <span class="math display">\[
x_3 = \bigg\{
\begin{matrix}
1, \text{ se Mazda6} \\
0, \text{ cc}\\
\end{matrix}
\]</span> e <span class="math display">\[
x_4 = \bigg\{
\begin{matrix}
1, \text{ se Accord} \\
0, \text{ cc}\\
\end{matrix}
\]</span></p>
<p>O modelo de regressão pode ser escrito conforme segue. <span class="math display">\[
\hat{y}_i = \beta_0 + \beta_1x_{i1} + \beta_2x_{i2} + \beta_3x_{i3} + \beta_4x_{i4}
\]</span></p>
<p>Fica claro que, neste tipo de modelo, o coeficiente <span class="math inline">\(\beta_3\)</span> é uma constante adicionada a <span class="math inline">\(\beta_0\)</span> caso o modelo do carro seja <code>Mazda6</code>. Uma explicação análoga pode ser feita para <span class="math inline">\(\beta_4\)</span>. Portanto, tais termos não mudam a inclinação do modelo, apenas o intercepto. É possível adicionar termos de interação entre variáveis dicotômicas e variáveis contínuas, o que na prática serviria para mudar a inclinação ou coeficientes das variáveis contínuas. Retomando a criação de variáveis dicotômicas para o exemplo em questão, tem-se as colunas com tais variáveis criadas a seguir.</p>
<div class="cell">
<div class="cell-output-display">

<div id="avwawposof" style="padding-left:0px;padding-right:0px;padding-top:10px;padding-bottom:10px;overflow-x:auto;overflow-y:auto;width:auto;height:auto;">
<style>#avwawposof table {
  font-family: system-ui, 'Segoe UI', Roboto, Helvetica, Arial, sans-serif, 'Apple Color Emoji', 'Segoe UI Emoji', 'Segoe UI Symbol', 'Noto Color Emoji';
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
}

#avwawposof thead, #avwawposof tbody, #avwawposof tfoot, #avwawposof tr, #avwawposof td, #avwawposof th {
  border-style: none;
}

#avwawposof p {
  margin: 0;
  padding: 0;
}

#avwawposof .gt_table {
  display: table;
  border-collapse: collapse;
  line-height: normal;
  margin-left: auto;
  margin-right: auto;
  color: #333333;
  font-size: 16px;
  font-weight: normal;
  font-style: normal;
  background-color: #FFFFFF;
  width: auto;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #A8A8A8;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #A8A8A8;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
}

#avwawposof .gt_caption {
  padding-top: 4px;
  padding-bottom: 4px;
}

#avwawposof .gt_title {
  color: #333333;
  font-size: 125%;
  font-weight: initial;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-color: #FFFFFF;
  border-bottom-width: 0;
}

#avwawposof .gt_subtitle {
  color: #333333;
  font-size: 85%;
  font-weight: initial;
  padding-top: 3px;
  padding-bottom: 5px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-color: #FFFFFF;
  border-top-width: 0;
}

#avwawposof .gt_heading {
  background-color: #FFFFFF;
  text-align: center;
  border-bottom-color: #FFFFFF;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#avwawposof .gt_bottom_border {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#avwawposof .gt_col_headings {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
}

#avwawposof .gt_col_heading {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 6px;
  padding-left: 5px;
  padding-right: 5px;
  overflow-x: hidden;
}

#avwawposof .gt_column_spanner_outer {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: normal;
  text-transform: inherit;
  padding-top: 0;
  padding-bottom: 0;
  padding-left: 4px;
  padding-right: 4px;
}

#avwawposof .gt_column_spanner_outer:first-child {
  padding-left: 0;
}

#avwawposof .gt_column_spanner_outer:last-child {
  padding-right: 0;
}

#avwawposof .gt_column_spanner {
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: bottom;
  padding-top: 5px;
  padding-bottom: 5px;
  overflow-x: hidden;
  display: inline-block;
  width: 100%;
}

#avwawposof .gt_spanner_row {
  border-bottom-style: hidden;
}

#avwawposof .gt_group_heading {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  text-align: left;
}

#avwawposof .gt_empty_group_heading {
  padding: 0.5px;
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  vertical-align: middle;
}

#avwawposof .gt_from_md > :first-child {
  margin-top: 0;
}

#avwawposof .gt_from_md > :last-child {
  margin-bottom: 0;
}

#avwawposof .gt_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  margin: 10px;
  border-top-style: solid;
  border-top-width: 1px;
  border-top-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 1px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 1px;
  border-right-color: #D3D3D3;
  vertical-align: middle;
  overflow-x: hidden;
}

#avwawposof .gt_stub {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
}

#avwawposof .gt_stub_row_group {
  color: #333333;
  background-color: #FFFFFF;
  font-size: 100%;
  font-weight: initial;
  text-transform: inherit;
  border-right-style: solid;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
  padding-left: 5px;
  padding-right: 5px;
  vertical-align: top;
}

#avwawposof .gt_row_group_first td {
  border-top-width: 2px;
}

#avwawposof .gt_row_group_first th {
  border-top-width: 2px;
}

#avwawposof .gt_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#avwawposof .gt_first_summary_row {
  border-top-style: solid;
  border-top-color: #D3D3D3;
}

#avwawposof .gt_first_summary_row.thick {
  border-top-width: 2px;
}

#avwawposof .gt_last_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#avwawposof .gt_grand_summary_row {
  color: #333333;
  background-color: #FFFFFF;
  text-transform: inherit;
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
}

#avwawposof .gt_first_grand_summary_row {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-top-style: double;
  border-top-width: 6px;
  border-top-color: #D3D3D3;
}

#avwawposof .gt_last_grand_summary_row_top {
  padding-top: 8px;
  padding-bottom: 8px;
  padding-left: 5px;
  padding-right: 5px;
  border-bottom-style: double;
  border-bottom-width: 6px;
  border-bottom-color: #D3D3D3;
}

#avwawposof .gt_striped {
  background-color: rgba(128, 128, 128, 0.05);
}

#avwawposof .gt_table_body {
  border-top-style: solid;
  border-top-width: 2px;
  border-top-color: #D3D3D3;
  border-bottom-style: solid;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
}

#avwawposof .gt_footnotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#avwawposof .gt_footnote {
  margin: 0px;
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#avwawposof .gt_sourcenotes {
  color: #333333;
  background-color: #FFFFFF;
  border-bottom-style: none;
  border-bottom-width: 2px;
  border-bottom-color: #D3D3D3;
  border-left-style: none;
  border-left-width: 2px;
  border-left-color: #D3D3D3;
  border-right-style: none;
  border-right-width: 2px;
  border-right-color: #D3D3D3;
}

#avwawposof .gt_sourcenote {
  font-size: 90%;
  padding-top: 4px;
  padding-bottom: 4px;
  padding-left: 5px;
  padding-right: 5px;
}

#avwawposof .gt_left {
  text-align: left;
}

#avwawposof .gt_center {
  text-align: center;
}

#avwawposof .gt_right {
  text-align: right;
  font-variant-numeric: tabular-nums;
}

#avwawposof .gt_font_normal {
  font-weight: normal;
}

#avwawposof .gt_font_bold {
  font-weight: bold;
}

#avwawposof .gt_font_italic {
  font-style: italic;
}

#avwawposof .gt_super {
  font-size: 65%;
}

#avwawposof .gt_footnote_marks {
  font-size: 75%;
  vertical-align: 0.4em;
  position: initial;
}

#avwawposof .gt_asterisk {
  font-size: 100%;
  vertical-align: 0;
}

#avwawposof .gt_indent_1 {
  text-indent: 5px;
}

#avwawposof .gt_indent_2 {
  text-indent: 10px;
}

#avwawposof .gt_indent_3 {
  text-indent: 15px;
}

#avwawposof .gt_indent_4 {
  text-indent: 20px;
}

#avwawposof .gt_indent_5 {
  text-indent: 25px;
}
</style>
<table class="gt_table" data-quarto-disable-processing="false" data-quarto-bootstrap="false">
  <thead>
    <tr class="gt_col_headings">
      <th class="gt_col_heading gt_columns_bottom_border gt_center" rowspan="1" colspan="1" scope="col" id="CarType">CarType</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Age">Age</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Price">Price</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Mileage">Mileage</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Mazda6">Mazda6</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Accord">Accord</th>
      <th class="gt_col_heading gt_columns_bottom_border gt_right" rowspan="1" colspan="1" scope="col" id="Maxima">Maxima</th>
    </tr>
  </thead>
  <tbody class="gt_table_body">
    <tr><td headers="CarType" class="gt_row gt_center">Mazda6</td>
<td headers="Age" class="gt_row gt_right">3</td>
<td headers="Price" class="gt_row gt_right">15.9</td>
<td headers="Mileage" class="gt_row gt_right">17.8</td>
<td headers="Mazda6" class="gt_row gt_right">1</td>
<td headers="Accord" class="gt_row gt_right">0</td>
<td headers="Maxima" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CarType" class="gt_row gt_center">Mazda6</td>
<td headers="Age" class="gt_row gt_right">2</td>
<td headers="Price" class="gt_row gt_right">16.4</td>
<td headers="Mileage" class="gt_row gt_right">19.0</td>
<td headers="Mazda6" class="gt_row gt_right">1</td>
<td headers="Accord" class="gt_row gt_right">0</td>
<td headers="Maxima" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CarType" class="gt_row gt_center">Accord</td>
<td headers="Age" class="gt_row gt_right">10</td>
<td headers="Price" class="gt_row gt_right">7.9</td>
<td headers="Mileage" class="gt_row gt_right">150.5</td>
<td headers="Mazda6" class="gt_row gt_right">0</td>
<td headers="Accord" class="gt_row gt_right">1</td>
<td headers="Maxima" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CarType" class="gt_row gt_center">Accord</td>
<td headers="Age" class="gt_row gt_right">5</td>
<td headers="Price" class="gt_row gt_right">11.7</td>
<td headers="Mileage" class="gt_row gt_right">65.2</td>
<td headers="Mazda6" class="gt_row gt_right">0</td>
<td headers="Accord" class="gt_row gt_right">1</td>
<td headers="Maxima" class="gt_row gt_right">0</td></tr>
    <tr><td headers="CarType" class="gt_row gt_center">Maxima</td>
<td headers="Age" class="gt_row gt_right">1</td>
<td headers="Price" class="gt_row gt_right">20.0</td>
<td headers="Mileage" class="gt_row gt_right">38.6</td>
<td headers="Mazda6" class="gt_row gt_right">0</td>
<td headers="Accord" class="gt_row gt_right">0</td>
<td headers="Maxima" class="gt_row gt_right">1</td></tr>
    <tr><td headers="CarType" class="gt_row gt_center">Maxima</td>
<td headers="Age" class="gt_row gt_right">1</td>
<td headers="Price" class="gt_row gt_right">20.0</td>
<td headers="Mileage" class="gt_row gt_right">42.1</td>
<td headers="Mazda6" class="gt_row gt_right">0</td>
<td headers="Accord" class="gt_row gt_right">0</td>
<td headers="Maxima" class="gt_row gt_right">1</td></tr>
  </tbody>
  
  
</table>
</div>
</div>
</div>
<p>O modelo com estas variáveis e as duas consideradas anteriormente ficaria conforme exposto a seguir.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Price ~ Mileage + Age + Mazda6 + Accord, data = data)

Residuals:
   Min     1Q Median     3Q    Max 
-4.588 -1.632 -0.178  1.196  6.861 

Coefficients:
            Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  14.5616     0.4082  35.672  &lt; 2e-16 ***
Mileage      -1.8975     0.4226  -4.490 2.23e-05 ***
Age          -3.2185     0.4253  -7.567 4.17e-11 ***
Mazda6       -2.1158     0.5750  -3.680 0.000409 ***
Accord       -0.3257     0.5873  -0.555 0.580651    
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 2.187 on 85 degrees of freedom
Multiple R-squared:  0.8517,    Adjusted R-squared:  0.8447 
F-statistic:   122 on 4 and 85 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
</section>
<section id="regressão-polinomial" class="level3">
<h3 class="anchored" data-anchor-id="regressão-polinomial">Regressão polinomial</h3>
<p>É possível em regressão simples ou múltipla realizar transformações nos preditores de forma a incluir termos polinomiais associados à uma ou mais variáveis independentes. Para o caso simples, um modelo de regressão polinomial pode ser escrito conforme segue, onde <span class="math inline">\(p\)</span> é a ordem do modelo de regressão polinomial.</p>
<p><span class="math display">\[
\hat{y} = \beta_0 + \beta_1x + \beta_2x^2 + \beta_3x^3 + ... \beta_px^p
\]</span></p>
<p>Considerando a notação matricial, a matriz <span class="math inline">\(\mathbf{X}\)</span> fica conforme segue, podendo-se utilizar novamente as equações normais de mínimos quadrados para estimar os coeficientes, <span class="math inline">\(\hat{\mathbf{\beta}} = (\mathbf{X}^T\mathbf{X})^{-1}(\mathbf{X}^T\mathbf{y})\)</span>.</p>
<p><span class="math display">\[
\mathbf{X} =
\begin{bmatrix}
1 &amp; x_{11} &amp; x_{11}^2 &amp; \cdots &amp; x_{p1}^p\\
1 &amp; x_{12} &amp; x_{12}^2 &amp; \cdots &amp; x_{p2}^p \\
\vdots &amp; \vdots &amp; \vdots &amp; \ddots &amp; \vdots\\
1 &amp; x_{1N} &amp; x_{1N}^2 &amp; \cdots &amp; x_{pN}^p \\
\end{bmatrix}\\
\]</span></p>
<p>Sejam os dados da massa de um paciente em kg medidos ao longo de 8 meses de um programa de perda de peso.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="AS_reg_ols_files/figure-html/unnamed-chunk-16-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Considerando um modelo linear para tais dados, os resíduos obtidos são plotados conforme segue. Pode-se observar claramente um padrão de não linearidade nos resíduos em relação aos valores ajustados, indicando o ajuste de um modelo não linear.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="AS_reg_ols_files/figure-html/unnamed-chunk-17-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Pode-se pensar, portanto, em um modelo de regressão quadrático para aproximar o peso em função de dias. A curva plotada a seguir consiste em tal modelo.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="AS_reg_ols_files/figure-html/unnamed-chunk-18-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>O modelo quadrático obtido e associado ao gráfico anterior é exposto a seguir.</p>
<div class="cell">
<div class="cell-output cell-output-stdout">
<pre><code>
Call:
lm(formula = Weight ~ Days + I(Days^2), data = rehab)

Residuals:
    Min      1Q  Median      3Q     Max 
-1.9034 -0.5842 -0.1188  0.4774  2.6315 

Coefficients:
              Estimate Std. Error t value Pr(&gt;|t|)    
(Intercept)  1.833e+02  3.521e-01  520.72   &lt;2e-16 ***
Days        -4.565e-01  6.520e-03  -70.03   &lt;2e-16 ***
I(Days^2)    6.930e-04  2.614e-05   26.51   &lt;2e-16 ***
---
Signif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1

Residual standard error: 0.9386 on 49 degrees of freedom
Multiple R-squared:  0.9981,    Adjusted R-squared:  0.998 
F-statistic: 1.287e+04 on 2 and 49 DF,  p-value: &lt; 2.2e-16</code></pre>
</div>
</div>
<p>Os resíduos para o modelo quadrático são plotados abaixo.</p>
<div class="cell">
<div class="cell-output-display">
<p><img src="AS_reg_ols_files/figure-html/unnamed-chunk-20-1.png" class="img-fluid" width="672"></p>
</div>
</div>
<p>Finalmente, tal modelo pode ser escrito conforme segue.</p>
<p><span class="math display">\[
\hat{y} = 183,3 -0,456x + 6,930\times10^{-4}x^2
\]</span></p>
</section>
<section id="referências" class="level3">
<h3 class="anchored" data-anchor-id="referências">Referências</h3>
<p>Hastie, T., Tibshirani, R., Friedman, J. H., &amp; Friedman, J. H. (2009). The elements of statistical learning: data mining, inference, and prediction (Vol. 2, pp.&nbsp;1-758). New York: springer.</p>
<p>Gareth, J., Daniela, W., Trevor, H., &amp; Robert, T. (2013). An introduction to statistical learning: with applications in R. Spinger.</p>
</section>
</section>

</main>
<!-- /main column -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button', {
    text: function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
  });
  clipboard.on('success', function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  });
  function tippyHover(el, contentFn) {
    const config = {
      allowHTML: true,
      content: contentFn,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start'
    };
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      return note.innerHTML;
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->



</body></html>